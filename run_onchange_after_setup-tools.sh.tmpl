#!/bin/bash

set -e

echo "========================================="
echo "Setting up development tools"
echo "========================================="

# .sshディレクトリの作成
echo "==> Checking .ssh directory..."
if [ ! -d "$HOME/.ssh" ]; then
    mkdir -p "$HOME/.ssh"
    chmod 700 "$HOME/.ssh"
    echo "✓ Created .ssh directory with proper permissions."
else
    echo ".ssh directory already exists."
    # パーミッションが正しいか確認して修正
    chmod 700 "$HOME/.ssh"
fi

# miseのインストール実行
echo ""
echo "==> Running mise install..."
if command -v mise >/dev/null 2>&1; then
    mise install
    echo "✓ mise install completed."
else
    echo "⚠️  Warning: mise is not installed or not in PATH."
    echo "   Please install mise first: https://mise.jdx.dev/"
    exit 1
fi

# claude code install
echo ""
echo "==> Checking Claude Code installation..."
if command -v claude >/dev/null 2>&1; then
    echo "Claude Code is already installed."
else
    echo "Installing Claude Code..."
    curl -fsSL https://claude.ai/install.sh | bash
    echo "✓ Claude Code installation completed."
fi


echo ""
echo "========================================="
echo "✓ Development tools setup completed!"
echo "========================================="
